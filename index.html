<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#000000" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>我的游戏</title>
    <meta name="description" content="使用GDevelop制作的HTML5游戏">
    
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        #canvasArea {
            margin-left: auto;
            margin-right: auto;
            overflow: hidden;
        }
        
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 18px;
            z-index: 9999;
        }
        
        .loading-spinner {
            border: 3px solid #333;
            border-top: 3px solid #fff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="loadingScreen">
        <div class="loading-spinner"></div>
        <div>游戏加载中...</div>
    </div>

    <!-- 游戏库文件 -->
    <script src="libs/jshashtable.js" crossorigin="anonymous"></script>
    <script src="logger.js" crossorigin="anonymous"></script>
    <script src="gd.js" crossorigin="anonymous"></script>
    <script src="libs/rbush.js" crossorigin="anonymous"></script>
    <script src="AsyncTasksManager.js" crossorigin="anonymous"></script>
    <script src="inputmanager.js" crossorigin="anonymous"></script>
    <script src="jsonmanager.js" crossorigin="anonymous"></script>
    <script src="Model3DManager.js" crossorigin="anonymous"></script>
    <script src="ResourceLoader.js" crossorigin="anonymous"></script>
    <script src="ResourceCache.js" crossorigin="anonymous"></script>
    <script src="timemanager.js" crossorigin="anonymous"></script>
    <script src="polygon.js" crossorigin="anonymous"></script>
    <script src="runtimeobject.js" crossorigin="anonymous"></script>
    <script src="profiler.js" crossorigin="anonymous"></script>
    <script src="RuntimeInstanceContainer.js" crossorigin="anonymous"></script>
    <script src="runtimescene.js" crossorigin="anonymous"></script>
    <script src="scenestack.js" crossorigin="anonymous"></script>
    <script src="force.js" crossorigin="anonymous"></script>
    <script src="RuntimeLayer.js" crossorigin="anonymous"></script>
    <script src="layer.js" crossorigin="anonymous"></script>
    <script src="RuntimeCustomObjectLayer.js" crossorigin="anonymous"></script>
    <script src="timer.js" crossorigin="anonymous"></script>
    <script src="runtimewatermark.js" crossorigin="anonymous"></script>
    <script src="runtimegame.js" crossorigin="anonymous"></script>
    <script src="variable.js" crossorigin="anonymous"></script>
    <script src="variablescontainer.js" crossorigin="anonymous"></script>
    <script src="oncetriggers.js" crossorigin="anonymous"></script>
    <script src="runtimebehavior.js" crossorigin="anonymous"></script>
    <script src="SpriteAnimator.js" crossorigin="anonymous"></script>
    <script src="spriteruntimeobject.js" crossorigin="anonymous"></script>
    <script src="affinetransformation.js" crossorigin="anonymous"></script>
    <script src="CustomRuntimeObjectInstanceContainer.js" crossorigin="anonymous"></script>
    <script src="CustomRuntimeObject.js" crossorigin="anonymous"></script>
    <script src="CustomRuntimeObject2D.js" crossorigin="anonymous"></script>
    
    <!-- 事件工具 -->
    <script src="events-tools/commontools.js" crossorigin="anonymous"></script>
    <script src="events-tools/variabletools.js" crossorigin="anonymous"></script>
    <script src="events-tools/runtimescenetools.js" crossorigin="anonymous"></script>
    <script src="events-tools/inputtools.js" crossorigin="anonymous"></script>
    <script src="events-tools/objecttools.js" crossorigin="anonymous"></script>
    <script src="events-tools/cameratools.js" crossorigin="anonymous"></script>
    <script src="events-tools/soundtools.js" crossorigin="anonymous"></script>
    <script src="events-tools/storagetools.js" crossorigin="anonymous"></script>
    <script src="events-tools/stringtools.js" crossorigin="anonymous"></script>
    <script src="events-tools/windowtools.js" crossorigin="anonymous"></script>
    <script src="events-tools/networktools.js" crossorigin="anonymous"></script>
    
    <!-- 渲染器 -->
    <script src="splash/gd-logo-light.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/pixi.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/pixi-filters-tools.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/runtimegame-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/runtimescene-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/layer-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/pixi-image-manager.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/pixi-bitmapfont-manager.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/spriteruntimeobject-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/CustomRuntimeObject2DPixiRenderer.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/DebuggerPixiRenderer.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/loadingscreen-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="pixi-renderers/pixi-effects-manager.js" crossorigin="anonymous"></script>
    
    <!-- 音频管理器 -->
    <script src="howler-sound-manager/howler.min.js" crossorigin="anonymous"></script>
    <script src="howler-sound-manager/howler-sound-manager.js" crossorigin="anonymous"></script>
    
    <!-- 字体管理器 -->
    <script src="fontfaceobserver-font-manager/fontfaceobserver.js" crossorigin="anonymous"></script>
    <script src="fontfaceobserver-font-manager/fontfaceobserver-font-manager.js" crossorigin="anonymous"></script>
    
    <!-- 扩展 -->
    <script src="Extensions/AnchorBehavior/anchorruntimebehavior.js" crossorigin="anonymous"></script>
    <script src="Extensions/DestroyOutsideBehavior/destroyoutsideruntimebehavior.js" crossorigin="anonymous"></script>
    <script src="Extensions/Leaderboards/leaderboardstools.js" crossorigin="anonymous"></script>
    <script src="Extensions/Leaderboards/sha256.js" crossorigin="anonymous"></script>
    <script src="Extensions/PanelSpriteObject/panelspriteruntimeobject-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="Extensions/PanelSpriteObject/panelspriteruntimeobject.js" crossorigin="anonymous"></script>
    <script src="Extensions/PlatformBehavior/platformerobjectruntimebehavior.js" crossorigin="anonymous"></script>
    <script src="Extensions/PlatformBehavior/platformruntimebehavior.js" crossorigin="anonymous"></script>
    <script src="Extensions/PlatformBehavior/platformtools.js" crossorigin="anonymous"></script>
    <script src="Extensions/PlayerAuthentication/playerauthenticationcomponents.js" crossorigin="anonymous"></script>
    <script src="Extensions/PlayerAuthentication/playerauthenticationtools.js" crossorigin="anonymous"></script>
    <script src="Extensions/TextInput/textinputruntimeobject-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="Extensions/TextInput/textinputruntimeobject.js" crossorigin="anonymous"></script>
    <script src="Extensions/TextObject/textruntimeobject-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="Extensions/TextObject/textruntimeobject.js" crossorigin="anonymous"></script>
    <script src="Extensions/TiledSpriteObject/tiledspriteruntimeobject-pixi-renderer.js" crossorigin="anonymous"></script>
    <script src="Extensions/TiledSpriteObject/tiledspriteruntimeobject.js" crossorigin="anonymous"></script>
    <script src="Extensions/TweenBehavior/TweenManager.js" crossorigin="anonymous"></script>
    <script src="Extensions/TweenBehavior/tweenruntimebehavior.js" crossorigin="anonymous"></script>
    
    <!-- 自定义扩展 -->
    <script src="gdjs-evtsext__ellipsemovement__ellipsemovement.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__flash__colortint-func.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__flash__flash.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__flash__istinted-func.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__flash__togglecolortint-func.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__flash__toggleeffect-func.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__flash__togglevisibility-func.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__leaderboarddialog__leaderboarddialog.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__panelspritebutton__buttonfsm.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__panelspritebutton__panelspritebutton.js" crossorigin="anonymous"></script>
    <script src="gdjs-evtsext__shakeobject__shakeobject_positionangle.js" crossorigin="anonymous"></script>
    
    <!-- 对象能力 -->
    <script src="object-capabilities/AnimatableBehavior.js" crossorigin="anonymous"></script>
    <script src="object-capabilities/EffectBehavior.js" crossorigin="anonymous"></script>
    <script src="object-capabilities/FlippableBehavior.js" crossorigin="anonymous"></script>
    <script src="object-capabilities/OpacityBehavior.js" crossorigin="anonymous"></script>
    <script src="object-capabilities/ResizableBehavior.js" crossorigin="anonymous"></script>
    <script src="object-capabilities/ScalableBehavior.js" crossorigin="anonymous"></script>
    <script src="object-capabilities/TextContainerBehavior.js" crossorigin="anonymous"></script>
    
    <!-- 效果 -->
    <script src="Extensions/Effects/drop-shadow-pixi-filter.js" crossorigin="anonymous"></script>
    <script src="Extensions/Effects/pixi-filters/filter-drop-shadow.js" crossorigin="anonymous"></script>
    <script src="Extensions/Effects/pixi-filters/filter-kawase-blur.js" crossorigin="anonymous"></script>
    
    <!-- 游戏代码 -->
    <script src="code0.js" crossorigin="anonymous"></script>
    <script src="code1.js" crossorigin="anonymous"></script>
    <script src="data.js" crossorigin="anonymous"></script>

    <script>
        (function() {
            // 隐藏加载屏幕
            function hideLoadingScreen() {
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
            }

            // 错误处理
            window.addEventListener('error', function(e) {
                console.error('游戏加载错误:', e.error);
                hideLoadingScreen();
                document.body.innerHTML = '<div style="color: white; text-align: center; padding: 50px;">游戏加载失败，请刷新页面重试</div>';
            });

            try {
                // 初始化游戏
                var game = new gdjs.RuntimeGame(gdjs.projectData, {});

                // 创建渲染器
                game.getRenderer().createStandardCanvas(document.body);

                // 绑定键盘/鼠标/触摸事件
                game.getRenderer().bindStandardEvents(game.getInputManager(), window, document);

                // 加载所有资源并启动游戏
                game.loadAllAssets(function() {
                    hideLoadingScreen();
                    game.startGameLoop();
                });
            } catch (error) {
                console.error('游戏初始化错误:', error);
                hideLoadingScreen();
                document.body.innerHTML = '<div style="color: white; text-align: center; padding: 50px;">游戏初始化失败，请检查浏览器兼容性</div>';
            }
        })();
    </script>
</body>
</html>
